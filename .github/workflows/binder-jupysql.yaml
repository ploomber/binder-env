name: binder-jupysql

on:
  push:
    branches: [main]
  schedule:
     - cron: '0 */6 * * *' # run every 6 hours

jobs:
  jupysql:
    runs-on: ubuntu-latest
    strategy:
      matrix:
        python-version: [3.11]

    steps:
      - uses: actions/checkout@v3
      - name: Set up Python ${{ matrix.python-version }}
        uses: actions/setup-python@v3
        with:
          python-version: ${{ matrix.python-version }}

      - name: Install dependencies
        run: |
          curl -O curl -O https://edgedl.me.gvt1.com/edgedl/chrome/chrome-for-testing/116.0.5845.96/linux64/chrome-linux64.zip
          unzip -j chrome-linux64.zip chrome-linux64/chrome
          mkdir -p /opt/google/chrome
          cp chrome /opt/google/chrome
          pip install selenium==4.11.2 webdriver-manager==4.0.0 packaging==23.1

      - name: Docker build
        run: |
          python docker-build.py https://binder.ploomber.io/v2/gh/ploomber/jupysql/master

